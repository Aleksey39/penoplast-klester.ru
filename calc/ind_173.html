<!DOCTYPE HTML>
<html>
<head>
<title>Роман Волгасов [SmalllSMK] </title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="ru" />
<!-- <script type="text/javascript" src="ajax.js"></script> -->
<script type="text/javascript" src="raphael-min.js"></script>

<style type="text/css">
.tab0 {background: #fff;border: 0px solid #333; vertical-align:top; border-spacing:5px;}
.tab0 tr {border: 0px solid #222;}
.tab0 td {border: 1px solid #222;  vertical-align:top; margin:5px; padding:5px;}
.tab0_td1 {border: 1px solid #222; width:340px; vertical-align:top; margin:5px; padding:5px;}
.tab_sek {border: 1px solid #222;}

#terl {visibility: visible; position: static; }
#sek1 {position: static;}
#sek2 {visibility: visible; position: static;}
#sek3 {visibility: hidden;  position: absolute;}
#sek4 {visibility: hidden;  position: absolute;}
#sek5 {visibility: hidden;  position: absolute;}
#sek6 {visibility: hidden;  position: absolute;}
#terr {visibility: visible; position: static;}

#pain1 {border: 1px solid #222;}
</style>
</head><body>


Роман Волгасов<br>
<br>
Требуется повторить калькулятор расчёта штакетника как на сайте:  
<br>
<hr>
<br>
<br>
<hr>
<br>



<table class="tab0"> <tr> <td class="tab0_td1">


<p>Укажите размеры в миллиметрах </p>
<p>Высота на краю H <input type="text" value="1400" id="H" onchange="fun_1()"> </p>
<p>Высота на середине Y <input type="text" value="1700" id="Y" onchange="fun_1()"> </p>
<p>Ширина секции X <input type="text" value="2500" id="X" onchange="fun_1()"> </p>
<p>Количество реек в секции K <input type="text" value="20" id="K" onchange="fun_1()"> </p>
<p>Ширина рейки Z <input type="text" value="70" id="Z" onchange="fun_1()"> </p>
<p>Оформление верха забора : <br>
треугольник <input id="p1"  name="p" type="radio" onchange="fun_1()" checked > <br>
арка <input class="" id="p2"  name="p" type="radio" onchange="fun_1()">
</p>
<p>Ширина столбика S <input type="text" value="80" id="S" onchange="fun_1()"> </p>  
 
<p>Вариант столбика <br>
1. Деревянный и секция забора прибивается к нему с внешней стороны <input class="" id="s1"  name="d" type="radio" onchange="fun_1()" checked ><br>
2. Каменный и концы секций забора монтируются внунрь столбика <input class="" id="s2"  name="d" type="radio" onchange="fun_1()"><br>
</p>
</td> <td >

<div id="pain1"> </div> <!-- Рисунок -->
</td> </tr> 
</table> 


<script language="JavaScript">

var paper1 = Raphael(document.getElementById("pain1"), 700, 700);
var arr = [];
fun_1();

//
// Главная функция рисования
//
function fun_1() {
	console.log('*************************************');
	
	smx = 100;
	smy = 100;

  rhhh = document.getElementById("H").value;    // Высота на краю H и высота столбика 
  ryyy = document.getElementById("Y").value;    // Высота на середине Y
  rxxx = document.getElementById("X").value;    // Ширина секции X
  rzzz = document.getElementById("Z").value;    // Ширина рейки Z
  rkkk = document.getElementById("K").value;    // Количество реек в секции K 
  rsss = document.getElementById("S").value;    // Ширина столбика S
  tt2 = rsss/2; 	// половина ширины столбика
  
  rss1 = document.getElementById("s1").checked;    // 
  rss2 = document.getElementById("s2").checked;    // 
  
  rpp1 = document.getElementById("p1").checked;    // 
  rpp2 = document.getElementById("p2").checked;    // 
  
  // Цвета
  if (rss2) { rsto = ' rgb(128, 128, 128) '; }; // Столбик каменный 
  if (rss1) { rsto = ' rgb(200, 130, 000) '; }; // Столбик деревянный
  rrei = ' rgb(255, 222, 173) '; // горизонтальная рейка
  rdos = ' rgb(255, 228, 196) '; // Доска
  
  rdww = document.getElementById("pain1").offsetWidth;
  rdhh = document.getElementById("pain1").offsetHeight;// - 250;
  
  if (rhhh > ryyy) { rrrr = rhhh; } else { rrrr = ryyy}; // высота максимальная
  
  sme = 80;
  rddw = rdww - sme - sme - rsss; // - rsss; // экран
  rddh = rdhh - sme; // экран
  console.log("rrrr", rrrr, rdww, rddw, rdhh, rddh);
  
  koew = rddw / rxxx;
  koeh = rddh / rrrr;
  koew = koew.toFixed(4);
  koeh = koeh.toFixed(4);
  if ( Number(koew) > Number(koeh) ) { koe = koeh; } else { koe = koew; };
  
  // шаг
  if (rss1) { // столбик деревянный / каменный
	ta  = rxxx; //-rsss;					// ширина = Ширина секции - Ширина столбика ( 2 половинки справа + слева)
	sme = 80; 
	smes2 = 80 + Number((rsss*koe)/2)
  } else {
	ta  = rxxx-rsss; // -rsss;
	sme = 80;
	smes2 = 80 + Number((rsss*koe)/2)
  };
  shag = ta / (rkkk);
  rsha = (shag*koe).toFixed(2);
  
  paper1.remove();
  paper1 = Raphael(document.getElementById("pain1"), 700, 700);
  paper1.clear();
  z1 = rsss * koe; z2 = z1.toFixed(0); console.log(z1 , z2); z3=(z2/2); //.toFixed(0);
 
  // Столбик левый
  w1=sme; h1=150; l1=(rhhh*koe).toFixed(0);
  paper1.path('m'+w1+','+h1+' v'+l1+' h'+z2+' v-'+l1+' z').attr({ fill: rsto, stroke:'#000', 'stroke-width': 1 });
  w1 = Number(sme) + Number(z3)
  paper1.path('m'+w1+','+h1+' v-120').attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Выноска наверх
  paper1.path('m'+w1+','+h1+' h-50').attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Выноска влево  верхняя
  h2 = Number(h1) + Number(l1);   
  paper1.path('m'+w1+','+h2+' h-70').attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Выноска влево  нижняя
  w3 =  60;  
  paper1.path('m'+w3+','+h2+' v-'+l1).attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Размерная линия высоты
  h3 = h2 - (l1/2)
  w3 =  50;  
  paper1.text( w3, h3, 'H = '+rhhh).attr({"font-size":"16", stroke:'#ccc'}).rotate(-90, w3, h3);
  w3 = 30;  
  l2 = (ryyy*koe).toFixed(0);
  l3 = 350;
  paper1.path('m'+w3+','+h2+' v-'+l2).attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Размерная линия высоты забора
  
  h5 = h1 - (( ryyy - rhhh)*koe).toFixed(0);
  w3 = 20
  paper1.path('m'+w3+','+h5+' h'+l3).attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Выноска верхняя высоты забора
  h4 = h2 / 2; w4=20
  paper1.text( w4, h4, 'Y = '+ryyy).attr({"font-size":"16", stroke:'#ccc'}).rotate(-90, w4, h4);
  
  // Столбик правый
  w2 = Number(sme) + Number((rxxx*koe).toFixed(0));// + Number(((rsss*koe)/2).toFixed(0));
  paper1.path('m'+w2+','+h1+' v'+l1+' h'+z2+' v-'+l1+' z').attr({ fill: rsto, stroke:'#000', 'stroke-width': 1 });
  w2 = Number(w2) + Number(z3)
  paper1.path('m'+w2+','+h1+' v-120').attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 }); // Выноска наверх 
  
  // Размерная линия ширина секции
  w1 = Number(sme) + Number(z3)
  h1=42; w2 = (rxxx*koe).toFixed(0);
  paper1.path('m'+w1+','+h1+' h'+w2+' z ').attr({ fill: rsto, stroke:'#aaa', 'stroke-width': 1 });

  // размер
  w1 = (rxxx*koe/2).toFixed(0);
  paper1.text( w1, 30, 'X = '+rxxx).attr({"font-size":"16", stroke:'#ccc'}); //.rotate(-90, x3, y3);
  
  // Горизонтальная рейка верхняя
  w3 = Number(z3)+Number(sme);
  h3 = 180;
  l3 = 25;
  w31 = (rxxx*koe).toFixed(0);
  paper1.path('m'+w3+','+h3+' v'+l3+' h'+w31+' v-'+l3+' z').attr({ fill: rrei, stroke:'#000', 'stroke-width': 1 });
  
  // Горизонтальная рейка нижняя
  h4 = Number(h3) + Number(rhhh*koe) - 100;
  paper1.path('m'+w3+','+h4+' v'+l3+' h'+w31+' v-'+l3+' z').attr({ fill: rrei, stroke:'#000', 'stroke-width': 1 });

  // доска
  if (rpp1) {
	h5 = 150;
	h51 = (rhhh * koe)-15;
	z5 = Number(rzzz*koe); 	// ширина рейки
	z51 = z5/2;				// 1/2 ширины рейки
	if (rss1) { // столбик деревянный / каменный
		w5 = Number(sme) + Number((rsss*koe)/2) + Number((rzzz*koe)/2); // столбик/2 + рейка/2
	} else {
		w5 = Number(sme) + Number((rsss*koe)) + Number((rzzz*koe)/2); // столбик/2 + рейка/2
	};
  
  ddd = ryyy - rhhh; // 
  delt = (((ddd / ((rkkk)/2))*koe)).toFixed(5);
  kolv = Math.trunc(((rkkk-1) / 2))
  kolf = kolv * 2;
  jj = true;
  arr=[];
  for (i=1; i<=rkkk; ++i) {
	w6 = w5;
	
	paper1.path('m'+w6+','+h5+' l-'+z51+',15 v'+h51+' h'+z5+' v-'+h51+' z ').attr({ fill: "rgb(255, 228, 196)", stroke:'#000', 'stroke-width': 1 });
	arr.push((h51/koe).toFixed(0)); 
	
	if (i==1) {
		w7 = Number(sme) + Number(z3)
		h7 = Number(h5) + Number(h51);
		paper1.path('m'+w7+','+h7+' v60').attr({ fill: "rgb(255, 228, 196)", stroke:'#aaa', 'stroke-width': 1 }); // Выноска вертикальная ширины рейки
		w8 = Number(w7) + Number(z5)
		paper1.path('m'+w8+','+h7+' v100').attr({ fill: "rgb(255, 228, 196)", stroke:'#aaa', 'stroke-width': 1 }); // Выноска вертикальная ширины рейки
		h8 = Number(h7) + Number(50)
		l8 = Number(z5) + Number(80)
		paper1.path('m'+w8+','+h8+' h-'+l8).attr({ fill: "rgb(255, 228, 196)", stroke:'#aaa', 'stroke-width': 1 }); // Размерная линия ширины рейки
		w9 = Number(w8) + Number(30) 
		h9 = h8 - 10
		paper1.text( 40, h9, 'X = '+rzzz).attr({"font-size":"16", stroke:'#ccc'});
		
		if ( Number(rzzz) < Number(shag) ) {
			h10 = Number(h8) + Number(20);
			w11 = Number(w7) +  Number(rsha);
			paper1.path('m'+w11+','+h7+' v100').attr({ fill: "rgb(255, 228, 196)", stroke:'#aaa', 'stroke-width': 1 }); // Выноска вертикальная ширины зазора
			paper1.path('m'+w8+','+h10+' h'+l8).attr({ fill: "rgb(255, 228, 196)", stroke:'#aaa', 'stroke-width': 1 }); // Размерная линия ширины зазора
			xxx = (shag - rzzz).toFixed(0);
			h11 = h10 - 15
			w12 = Number(w11) + Number(50)
			paper1.text( w12, h11, 'Зазор = '+xxx).attr({"font-size":"16", stroke:'#ccc'});
		}
	};
	w5 += Number(rsha);
	if (rpp1) {
		if (i <= kolv) { 
			h5 -= Number(delt); h51 +=Number(delt); 
		} else {
			if (kolv != kolf) {
				if (jj) {
					jj = false;
				} else {
					h5 += Number(delt); h51 -= Number(delt);
				};
			};
		};
	};
  };
  };
  if (rpp2) {
	fun_ark ();
  };
  kkk = (15/koe).toFixed(0);
  console.log('arr=', arr);
  paper1.text( 70, 550, 'Высота реек (мм)').attr({"font-size":"12", stroke:'#333', 'stroke-width': 0.5});
  j = 1; w = 0;
  for (i=0; i<arr.length; i++) {
	paper1.text( (80*j), 570+w, '№ '+(i+1) + " : " + (Number(arr[i])+Number(kkk)) + "; ").attr({"font-size":"12", stroke:'#333', 'stroke-width': 0.5});
	++j;
	if (j >= 8) {
		j = 1; w += 25;
	};
  };
};


function fun_ark () {
	arr=[];
	if (rss1) { // столбик деревянный / каменный
		ta  = rxxx-rsss;					// ширина = Ширина секции - Ширина столбика ( 2 половинки справа + слева)
	} else {
		ta  = rxxx-rsss-rsss;
	};
	ka1 = (ta/2).toFixed(0); //(rxxx/2)-(rsss/2);			// катет = Ширина секции/2 - Ширина столбика/2
	ka2 = Math.abs(ryyy-rhhh);			// катет = Высота на краю - Высота на середине
	gi1 = (ka1*ka1) + (ka2*ka2);		// сумма квадратов катетов
	gi  = Math.sqrt(gi1).toFixed(0);	// гипотенуза (от верхней, средней точки до верха столбика)
	//console.log('ka1' , ka1, 'ka2', ka2, 'gi', gi);
	zz1 = ta * gi * gi;												// ширина * гипотенуза * гипотенуза
	zz2 = (Number(ta) + Number(gi) + Number(gi)).toFixed(0);		// ширина + гипотенуза + гипотенуза
	zz3 = (Number(-ta) + Number(gi) + Number(gi)).toFixed(0);		// - ширина + гипотенуза + гипотенуза
	zz4 = (Number(ta) - Number(gi) + Number(gi)).toFixed(0);		// ширина - гипотенуза + гипотенуза
	zz5 = (Number(ta) + Number(gi) - Number(gi)).toFixed(0);		// ширина + гипотенуза - гипотенуза
	zz6 = zz2 * zz3 * zz4 * zz5;		// 
	zz7 = Math.sqrt(zz6).toFixed(0);								// низ формулы (делитель)
	zz8 = (zz1 / zz7).toFixed(0); 									// радиус (по формуле описанной окружности)
	del = ((ta / rkkk)*koe).toFixed(0); 					// шаг реек = (ширина / кол реек)
	zz9 = (zz8 * koe).toFixed(0); // радиус с koe
	zzb = Number(sme) + Number((rxxx*koe)/2) + Number(z3)
	v1=Number(zz9) + 150;
	if (rss1) { // столбик деревянный / каменный
		w5 = Number(sme) + Number((rsss*koe)/2) + Number((rzzz*koe)/2); // столбик/2 + рейка/2
	} else {
		w5 = Number(sme) + Number((rsss*koe)) + Number((rzzz*koe)/2); // столбик + рейка/2
	};
	v5 = v1 - (( ryyy - rhhh)*koe).toFixed(0);
	zza = zz9 - sme + ((rxxx*koe)/2)
	zza = zz9 - 220
	j = 0;
	nnh = 150;
	r1 = zz9*zz9;	// квадрат гипотенузы (радиус)
	khhn = Number(nnh) + Number((rhhh*koe)); // координ низа штакетника
	z5 = Number(rzzz*koe); 	// ширина рейки
	z51 = z5/2;				// 1/2 ширины рейки
	kg1 = 0; kg2 = 0;
	del = Number(rsha);
	for (i = 0; i < rkkk; ++i) {
		v7 = Number((rzzz*koe)).toFixed(0); // ширина рейки
		if (rss1) { // столбик деревянный / каменный
			v6 = Number(sme) + Number(z3) + Number(v7/2) + (del*i);
			r2 = Math.abs ( ((rxxx*koe)/2) - ((rsss*koe)/2) - (del*i) ).toFixed(0);	 // ширина секции/2 - ширина столбика/2 (горизонтальный катет)
		} else {
			v6 = Number(sme) + Number(z2) + Number(v7/2) + (del*i);
			r2 = Math.abs ( ((rxxx*koe)/2) - ((rsss*koe)) - (del*i) ).toFixed(0);	 // ширина секции/2 - ширина столбика/2 (горизонтальный катет)
		}
		rx3 = (del*i);
		kg = Math.sqrt( r1 - (r2*r2) ).toFixed(0);
		if (i !=0) {kg2 += kg-kg1;};
		rrh = (Number(0) + Number(rhhh*koe) - 15 + Number(kg2)).toFixed(0);
		paper1.path('m'+v6+','+(v5-kg)+' l-'+z51+',15 l0,'+rrh + 'h'+z5+'l0,-'+rrh+' z').attr({ fill: "rgb(255, 228, 196)", stroke:'#000', 'stroke-width': 1 });	
		arr.push((rrh/koe).toFixed(0));
		nn = Number(r2) - Number(kg)
		kg1 = kg;
		if (ryyy < rhhh) { // край выше центра
			kg = kg - zz8;
		} else {
			kg = zz8 - kg;
		};
	};
};
</script>
</body></html>
